================================================================================
SPARK EXECUTION PLAN - 2025-12-01 22:23:51.920262
================================================================================

== Parsed Logical Plan ==
'Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, rawPrediction#744, probability#770, UDF('rawPrediction) AS prediction#799 AS prediction#800]
+- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, rawPrediction#744, UDF(rawPrediction#744) AS probability#770]
   +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, UDF(features#717) AS rawPrediction#744]
      +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, UDF(features_raw#693) AS features#717]
         +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, UDF(struct(return_1h, return_1h#45, ma_24h, ma_24h#46, volume_24h, volume_24h#47, volatility_24h, volatility_24h#48, blocks_per_hour_double_VectorAssembler_c00dcf282577, cast(blocks_per_hour#51L as double), total_txs_double_VectorAssembler_c00dcf282577, cast(total_txs#52L as double), avg_block_size, avg_block_size#53)) AS features_raw#693]
            +- Filter atleastnnonnulls(8, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, target_direction#55)
               +- Relation [timestamp#38L,open#39,high#40,low#41,close#42,volume#43,datetime#44,return_1h#45,ma_24h#46,volume_24h#47,volatility_24h#48,hour_ts#49,hour#50,blocks_per_hour#51L,total_txs#52L,avg_block_size#53,future_close#54,target_direction#55,target_magnitude#56] parquet

== Analyzed Logical Plan ==
timestamp: bigint, open: string, high: string, low: string, close: string, volume: string, datetime: string, return_1h: double, ma_24h: double, volume_24h: double, volatility_24h: double, hour_ts: string, hour: string, blocks_per_hour: bigint, total_txs: bigint, avg_block_size: double, future_close: string, target_direction: int, target_magnitude: double, features_raw: vector, features: vector, rawPrediction: vector, probability: vector, prediction: double
Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, rawPrediction#744, probability#770, UDF(rawPrediction#744) AS prediction#800]
+- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, rawPrediction#744, UDF(rawPrediction#744) AS probability#770]
   +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, UDF(features#717) AS rawPrediction#744]
      +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, UDF(features_raw#693) AS features#717]
         +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, UDF(struct(return_1h, return_1h#45, ma_24h, ma_24h#46, volume_24h, volume_24h#47, volatility_24h, volatility_24h#48, blocks_per_hour_double_VectorAssembler_c00dcf282577, cast(blocks_per_hour#51L as double), total_txs_double_VectorAssembler_c00dcf282577, cast(total_txs#52L as double), avg_block_size, avg_block_size#53)) AS features_raw#693]
            +- Filter atleastnnonnulls(8, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, target_direction#55)
               +- Relation [timestamp#38L,open#39,high#40,low#41,close#42,volume#43,datetime#44,return_1h#45,ma_24h#46,volume_24h#47,volatility_24h#48,hour_ts#49,hour#50,blocks_per_hour#51L,total_txs#52L,avg_block_size#53,future_close#54,target_direction#55,target_magnitude#56] parquet

== Optimized Logical Plan ==
Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, rawPrediction#744, UDF(rawPrediction#744) AS probability#770, UDF(rawPrediction#744) AS prediction#800]
+- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, UDF(features#717) AS rawPrediction#744]
   +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, UDF(features_raw#693) AS features#717]
      +- Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, UDF(struct(return_1h, return_1h#45, ma_24h, ma_24h#46, volume_24h, volume_24h#47, volatility_24h, volatility_24h#48, blocks_per_hour_double_VectorAssembler_c00dcf282577, cast(blocks_per_hour#51L as double), total_txs_double_VectorAssembler_c00dcf282577, cast(total_txs#52L as double), avg_block_size, avg_block_size#53)) AS features_raw#693]
         +- Filter atleastnnonnulls(8, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, target_direction#55)
            +- Relation [timestamp#38L,open#39,high#40,low#41,close#42,volume#43,datetime#44,return_1h#45,ma_24h#46,volume_24h#47,volatility_24h#48,hour_ts#49,hour#50,blocks_per_hour#51L,total_txs#52L,avg_block_size#53,future_close#54,target_direction#55,target_magnitude#56] parquet

== Physical Plan ==
*(1) Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, rawPrediction#744, UDF(rawPrediction#744) AS probability#770, UDF(rawPrediction#744) AS prediction#800]
+- *(1) Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, features#717, UDF(features#717) AS rawPrediction#744]
   +- *(1) Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, features_raw#693, UDF(features_raw#693) AS features#717]
      +- *(1) Project [timestamp#38L, open#39, high#40, low#41, close#42, volume#43, datetime#44, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, hour_ts#49, hour#50, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, future_close#54, target_direction#55, target_magnitude#56, UDF(struct(return_1h, return_1h#45, ma_24h, ma_24h#46, volume_24h, volume_24h#47, volatility_24h, volatility_24h#48, blocks_per_hour_double_VectorAssembler_c00dcf282577, cast(blocks_per_hour#51L as double), total_txs_double_VectorAssembler_c00dcf282577, cast(total_txs#52L as double), avg_block_size, avg_block_size#53)) AS features_raw#693]
         +- *(1) Filter atleastnnonnulls(8, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, blocks_per_hour#51L, total_txs#52L, avg_block_size#53, target_direction#55)
            +- *(1) ColumnarToRow
               +- FileScan parquet [timestamp#38L,open#39,high#40,low#41,close#42,volume#43,datetime#44,return_1h#45,ma_24h#46,volume_24h#47,volatility_24h#48,hour_ts#49,hour#50,blocks_per_hour#51L,total_txs#52L,avg_block_size#53,future_close#54,target_direction#55,target_magnitude#56] Batched: true, DataFilters: [atleastnnonnulls(8, return_1h#45, ma_24h#46, volume_24h#47, volatility_24h#48, blocks_per_hour#5..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/home/aurel/bda-project/data/processed/test_features.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<timestamp:bigint,open:string,high:string,low:string,close:string,volume:string,datetime:st...
